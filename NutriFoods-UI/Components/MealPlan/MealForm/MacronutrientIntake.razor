@page "/macro"
@using NutriFoods_UI.Data.Enums
@using Fluxor
@using NutriFoods_UI.Data.Store
@using NutriFoods_UI.Pages

<div class="container">
    <div class="d-flex flex-column flex-grow-1 gap-1">
        <span>@MacroType.ReadableName</span>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt</p>
    </div>

    <div class="d-flex gap-3">
        <input type="range" min="0.6" max="1.5" step="0.1" @bind="MacroValueHandler"/>
        <input type="number" min="0.6" max="1.5" @bind="MacroValueHandler">
    </div>

</div>


@code {

    [Parameter]
    public MacroTypeEnum MacroType { get; set; }

    [Parameter]
    public double PacientWeight { get; set; }

    private double _macroValue;

    [Parameter]
    public EventCallback<double> OnMacroValueChanged { get; set; }
    
    private double MacroValueHandler
    {
        get => _macroValue;
        set
        {
            if (_macroValue == value) return;
            _macroValue = value;
            var action = new ChangeMoleculaAction(_macroValue, MacroType);
            Dispatcher.Dispatch(action);
            OnMacroValueChanged.InvokeAsync();
        }
    }

    [CascadingParameter]
    private IState<MoleculaState> MoleculaState { get; set; } = null!;

    [Inject]
    public IDispatcher Dispatcher { get; set; } = null!;

}